% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepare_data.R
\name{prepare_irt_data}
\alias{prepare_irt_data}
\title{Prepare IRT Data for Estimation}
\usage{
prepare_irt_data(
  response_data,
  item_loadings,
  threshold_left,
  threshold_right,
  person_covariates = NULL,
  weights = NULL,
  K = NULL
)
}
\arguments{
\item{response_data}{Data frame with columns: pid (person ID), iid (item ID).
Person IDs should be consecutive integers from 1 to N.}

\item{item_loadings}{Matrix of factor loadings (L x K), where L is the number
of response observations and K is the number of dimensions.}

\item{threshold_left}{Numeric vector of left thresholds for each response (length L).
Use Inf for -infinity boundaries.}

\item{threshold_right}{Numeric vector of right thresholds for each response (length L).
Use Inf for +infinity boundaries.}

\item{person_covariates}{Optional matrix of person-level covariates (N x J).
If NULL, an intercept-only model is used.}

\item{weights}{Optional vector of person weights (length N). If NULL, all
persons receive equal weight of 1.}

\item{K}{Optional number of dimensions. If NULL, auto-detected from item_loadings.}
}
\value{
List formatted for Stan model with components:
\item{inf}{Code for infinity (-999)}
\item{L}{Number of response observations}
\item{N}{Number of persons}
\item{J}{Number of covariates}
\item{K}{Number of dimensions}
\item{pid}{Person ID vector}
\item{dL}{Left thresholds (infinities replaced with -999)}
\item{dR}{Right thresholds (infinities replaced with -999)}
\item{wgt}{Person weights}
\item{X}{Covariate matrix}
\item{A}{Loading matrix}
}
\description{
Validates and formats IRT data for Stan model estimation. Converts response
data and parameters into the format required by the Stan model.
}
\details{
The function performs comprehensive validation:
\itemize{
\item Checks that response_data has required columns (pid, iid)
\item Validates that person IDs are consecutive integers
\item Ensures item_loadings is a matrix with correct dimensions
\item Validates threshold vectors have correct length
\item Checks that left thresholds <= right thresholds
\item Replaces infinite thresholds with code -999 for Stan
}
}
\examples{
\dontrun{
# Simple unidimensional example
response_data <- data.frame(
  pid = c(1, 1, 2, 2),
  iid = c(1, 2, 1, 2)
)
loadings <- matrix(c(1, 1.5), ncol = 1)
thresh_L <- c(-Inf, -1)
thresh_R <- c(-1, Inf)

stan_data <- prepare_irt_data(
  response_data = response_data,
  item_loadings = loadings,
  threshold_left = thresh_L,
  threshold_right = thresh_R
)
}

}
